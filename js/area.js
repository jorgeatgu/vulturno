const areaInput=()=>{const t={top:16,right:16,bottom:24,left:32};let e=0,a=0;const n=d3.select(".chart-lluvia-input"),c=n.select("svg");let s={};const i=(t,e)=>{s.count.x.range([0,t]),s.count.y.range([e,0])},o=t=>{const n=d3.axisBottom(s.count.x).tickPadding(5).tickFormat(d3.format("d")).ticks(13);t.select(".axis-x").attr("transform","translate(0,"+a+")").transition().duration(300).ease(d3.easeLinear).call(n);const c=d3.axisLeft(s.count.y).tickPadding(5).tickFormat(t=>t+"ÂºC").tickSize(-e).ticks(6);t.select(".axis-y").transition().duration(300).ease(d3.easeLinear).call(c)};function r(r){const l=n.node().offsetWidth;e=l-t.left-t.right,a=400-t.top-t.bottom,c.attr("width",l).attr("height",400);const d="translate("+t.left+","+t.top+")",p=c.select(".chart-lluvia-input-container");p.attr("transform",d);const m=d3.area().x(t=>s.count.x(t.year)).y0(a).y1(t=>s.count.y(t.temp));i(e,a);const u=n.select(".area-input-container"),y=u.selectAll(".area").data([r]),x=y.enter().append("path").attr("class","area area-bgc7"),g=u.selectAll(".circles").data(r),v=g.enter().append("circle").attr("class","circles").attr("fill","#921d5d").attr("opacity",1);y.merge(x).transition().duration(600).ease(d3.easeLinear).attr("d",m),g.merge(v).transition().duration(600).ease(d3.easeLinear).attr("cx",t=>s.count.x(t.year)).attr("cy",t=>s.count.y(t.temp)).attr("r",3),o(p)}window.addEventListener("resize",()=>{d3.csv("csv/total-media-limpio.csv",(t,e)=>{const a=d3.select("#mes-mensual-minima").select("select").property("value");r(e=e.filter(t=>String(t.mes).match(a)))})}),d3.csv("csv/1249I.csv",(t,e)=>{t?console.log(t):(e.forEach(t=>{t.year=t.year,t.temp=t.temp}),(()=>{const t=c.select(".chart-lluvia-input-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","area-input-container")})(),(()=>{const t=d3.scaleTime().domain([1950,2017]),e=d3.scaleLinear().domain([14,23]);s.count={x:t,y:e}})(),r(e))}),d3.csv("csv/stations.csv",(t,n)=>{if(t)console.log(t);else{const t=d3.nest().key(t=>t.Name).entries(n);console.log(t);const c=d3.select("#select-city");c.selectAll("option").data(t).enter().append("option").attr("value",t=>t.key).text(t=>t.key),c.on("change",function(){!function(t){d3.csv("csv/"+t+".csv",(t,n)=>{n.forEach(t=>{t.temp=+t.temp,t.year=t.year}),s.count.x.range([0,e]),s.count.y.range([a,0]);const c=d3.scaleTime().domain([d3.min(n,t=>t.year),d3.max(n,t=>t.year)]),i=d3.scaleLinear().domain([d3.min(n,t=>t.temp-5),d3.max(n,t=>t.temp+5)]);s.count={x:c,y:i},r(n)})}(d3.select(this).property("value"))})}})};areaInput(),new SlimSelect({select:"#select-city"});
function menu(){var t=document.querySelector(".overlay"),e=document.querySelector(".navegacion"),a=document.querySelector("body"),n=document.querySelectorAll(".navegacion-btn"),o=document.querySelector(".burger");function c(){o.classList.toggle("clicked"),t.classList.toggle("show"),e.classList.toggle("show"),a.classList.toggle("overflow")}for(document.querySelector(".burger").addEventListener("click",c),document.querySelector(".overlay").addEventListener("click",c),i=0;i<n.length;i++)n[i].addEventListener("click",function(){r(),console.log("click")});function r(){t.classList.remove("show"),e.classList.remove("show"),o.classList.remove("clicked")}}menu();const vulturno=()=>{const t=window.innerWidth>0?window.innerWidth:screen.width;margin=t>544?{top:16,right:16,bottom:24,left:48}:{top:16,right:16,bottom:24,left:32};let e=0,a=0;const n=d3.select(".chart-vulturno"),o=n.select("svg");let c={};let r,s,i;const l=n.append("div").attr("class","tooltip tooltip-temp").style("opacity",0),d=d3.bisector(t=>t.year).left,m=(t,e)=>{c.count.x.range([0,t]),c.count.y.range([e,0])},u=t=>{const o=d3.axisBottom(c.count.x).tickPadding(5).tickFormat(d3.format("d")).ticks(13);t.select(".axis-x").attr("transform","translate(0,"+a+")").transition().duration(300).ease(d3.easeLinear).call(o);const s=d3.axisLeft(c.count.y).tickPadding(5).tickFormat(t=>t+"ºC").tickSize(-e).ticks(6);t.select(".axis-y").transition().duration(300).ease(d3.easeLinear).call(s);const i=t.select(".focus"),m=t.select(".overlay");i.select(".x-hover-line").attr("y2",a),m.attr("width",e+margin.left+margin.right).attr("height",a).on("mouseover",function(){i.style("display",null)}).on("mouseout",function(){i.style("display","none"),l.style("opacity",0)}).on("mousemove",function(){const t=n.node().offsetWidth/2-176,e=c.count.x.invert(d3.mouse(this)[0]),a=d(r,e,1),o=r[a-1],s=r[a],m=e-o.temp>s.temp-e?s:o;l.style("opacity",1).html(`<p class="tooltip-media-texto">En <strong>${m.year}</strong> la temperatura media fue de <strong>${m.temp} ºC</strong>.<p/>`).style("left",t+"px"),i.select(".x-hover-line").attr("transform",`translate(${c.count.x(m.fecha)},0)`)})};function p(t){const s=n.node().offsetWidth;e=s-margin.left-margin.right,a=500-margin.top-margin.bottom,o.attr("width",s).attr("height",500);const i="translate("+margin.left+","+margin.top+")",l=o.select(".chart-vulturno-container");l.attr("transform",i);const d=d3.line().x(t=>c.count.x(t.year)).y(t=>c.count.y(t.temp)).curve(d3.curveCardinal.tension(.6));m(e,a);const p=n.select(".chart-vulturno-container-bis"),y=p.selectAll(".lines").data([r]),x=y.enter().append("path").attr("class","lines"),g=p.selectAll(".circles").remove().exit().data(r),f=g.enter().append("circle").attr("class","circles");y.merge(x).transition().duration(600).ease(d3.easeLinear).attr("d",d),g.merge(f).attr("cx",t=>c.count.x(t.year)).attr("cy",0).transition().delay(function(t,e){return 10*e}).duration(300).ease(d3.easeLinear).attr("cx",t=>c.count.x(t.year)).attr("cy",t=>c.count.y(t.temp)),u(l)}function y(t){d3.csv("csv/"+t+".csv",(t,n)=>{(r=n).forEach(t=>{t.temp=+t.temp,t.year=t.year,t.fecha=+t.year,t.tempmax=+t.tempmax,t.yearmax=t.yearmax,t.tempmin=+t.tempmin,t.yearmin=t.yearmin}),c.count.x.range([0,e]),c.count.y.range([a,0]);const o=d3.scaleTime().domain([d3.min(r,t=>t.year),d3.max(r,t=>t.year)]),l=d3.scaleLinear().domain([d3.min(r,t=>t.temp-1),d3.max(r,t=>t.temp+1)]);c.count={x:o,y:l},p(),s.data(r).html(function(t){return"<p class='tooltip-media-texto'>La temperatura media máxima fue de <strong>"+d3.max(r,t=>t.tempmax)+"ºC</strong> en <strong>"+t.yearmax}),i.data(r).html(function(t){return"<p class='tooltip-media-texto'>La temperatura media mínima fue de <strong>"+d3.min(r,t=>t.tempmin)+"ºC</strong> en <strong>"+t.yearmin})})}window.addEventListener("resize",()=>{const t=d3.select("#select-city").property("value").replace(/[\u00f1-\u036f]/g,"");d3.csv("csv/"+t+".csv",(t,e)=>{r=e,p()})}),d3.csv("csv/Albacete.csv",(t,e)=>{t?console.log(t):((r=e).forEach(t=>{t.year=t.year,t.temp=t.temp,t.fecha=+t.year}),(()=>{const t=o.select(".chart-vulturno-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","chart-vulturno-container-bis"),t.append("rect").attr("class","overlay"),t.append("g").attr("class","focus").style("display","none").append("line").attr("class","x-hover-line hover-line").attr("y1",0),t.select(".focus").append("text").attr("class","text-focus")})(),(()=>{const t=d3.scaleTime().domain([d3.min(r,t=>t.year),d3.max(r,t=>t.year)]),e=d3.scaleLinear().domain([d3.min(r,t=>t.temp-1),20]);c.count={x:t,y:e}})(),p(),(t=>{s=n.append("div").attr("class","tooltip tooltip-media-anual-maxima").attr("id","tooltip-max"),i=n.append("div").attr("class","tooltip tooltip-media-anual-minima"),s.data(r).html(function(t){return"<p class='tooltip-media-texto'>La temperatura media máxima fue de <strong>"+d3.max(r,t=>t.tempmax)+"ºC</strong> en <strong>"+t.yearmax}),i.data(r).html(function(t){return"<p class='tooltip-media-texto'>La temperatura media mínima fue de <strong>"+d3.min(r,t=>t.tempmin)+"ºC</strong> en <strong>"+t.yearmin})})(),mes="Albacete",y(mes))}),d3.csv("csv/stations.csv",(t,e)=>{if(t)console.log(t);else{r=e;const t=d3.nest().key(t=>t.Name).entries(r),a=d3.select("#select-city");a.selectAll("option").data(t).enter().append("option").attr("value",t=>t.key).text(t=>t.key),a.on("change",function(){y(d3.select(this).property("value").replace(/[\u00f1-\u036f]/g,""))})}})};vulturno(),new SlimSelect({select:"#select-city",searchPlaceholder:"Busca tu ciudad"});const maxvul=()=>{const t=24,e=48,a=24,n=24;let o=0,c=0,r=0,s=0;const i=d3.select(".chart-temperature-max"),l=i.select("svg"),d={};let m;const u=m=>{r=i.node().offsetWidth,o=r-n-e,c=(s=200)-t-a,l.attr("width",r).attr("height",s);const u="translate("+n+","+t+")",p=l.select(".chart-temperature-max-container");p.attr("transform",u),(t=>{d.count.x.range([0,t])})(o);const y=i.select(".chart-temperature-max-container-bis").selectAll(".circles-max").data(m),x=y.enter().append("circle").attr("class","circles-max");y.merge(x).attr("cx",t=>d.count.x(t.fecha)).attr("cy",c/2).attr("r",0).transition().delay(function(t,e){return 10*e}).duration(300).attr("r",t=>3*t.total).attr("fill-opacity",.6),(t=>{const e=d3.axisBottom(d.count.x).tickFormat(d3.format("d")).ticks(6).tickPadding(30);t.select(".axis-x").attr("transform","translate(0,"+c/2+")").call(e)})(p)};window.addEventListener("resize",()=>{u(m)}),d3.csv("csv/max-record.csv",(t,e)=>{t?console.log(t):((m=e).forEach(t=>{t.fecha=t.yearmax,t.total=t.totalmax}),(()=>{const t=l.select(".chart-temperature-max-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","chart-temperature-max-container-bis")})(),(()=>{const t=d3.scaleLinear().domain([d3.min(m,function(t){return t.fecha}),d3.max(m,function(t){return t.fecha})]),e=d3.scaleLinear().domain([d3.min(m,t=>t.total),d3.max(m,t=>t.total)]);d.count={x:t,y:e}})(),d3.csv("csv/max-record.csv",(t,e)=>{if(t)console.log(t);else{(m=e).forEach(t=>{t.fecha=t.yearmax,t.total=t.totalmax});const t=[{data:{year:2012},y:100,dy:-50,dx:-52,note:{title:"Entre 2009 y 2018 se establecen el 78% de los récords de máximas",wrap:230,align:"middle"}}].map(t=>(t.subject={radius:4},t));window.makeAnnotations=d3.annotation().annotations(t).type(d3.annotationCalloutCircle).accessors({x:t=>d.count.x(t.year),y:t=>d.count.y(t.total)}).accessorsInverse({year:t=>d.count.x.invert(t.x),total:t=>d.count.y.invert(t.y)}).on("subjectover",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!1)}).on("subjectout",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!0)}),l.append("g").attr("class","annotation-test").call(makeAnnotations),l.selectAll("g.annotation-connector, g.annotation-note")}}),u(m))})};maxvul();const minvul=()=>{const t=24,e=48,a=24,n=24;let o=0,c=0,r=0,s=0;const i=d3.select(".chart-temperature-min"),l=i.select("svg"),d={};let m;const u=m=>{r=i.node().offsetWidth,o=r-n-e,c=(s=200)-t-a,l.attr("width",r).attr("height",s);const u="translate("+n+","+t+")",p=l.select(".chart-temperature-min-container");p.attr("transform",u),(t=>{d.count.x.range([0,t])})(o),(t=>{const e=d3.axisBottom(d.count.x).tickFormat(d3.format("d")).ticks(6).tickPadding(30);t.select(".axis-x").attr("transform","translate(0,"+c/2+")").call(e)})(p);const y=i.select(".chart-temperature-min-container-bis").selectAll(".circles-min").data(m),x=y.enter().append("circle").attr("class","circles-min");y.merge(x).attr("cx",t=>d.count.x(t.fecha)).attr("cy",c/2).attr("r",0).transition().delay(function(t,e){return 10*e}).duration(300).attr("r",t=>3*t.total).attr("fill-opacity",.6)};window.addEventListener("resize",()=>{u(m)}),d3.csv("csv/min-record.csv",(t,e)=>{t?console.log(t):((m=e).forEach(t=>{t.fecha=t.yearmin,t.total=t.totalmin}),(()=>{const t=l.select(".chart-temperature-min-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","chart-temperature-min-container-bis")})(),(()=>{const t=d3.scaleLinear().domain([d3.min(m,function(t){return t.fecha}),d3.max(m,function(t){return t.fecha})]);d.count={x:t}})(),d3.csv("csv/min-record.csv",(t,e)=>{if(t)console.log(t);else{(m=e).forEach(t=>{t.fecha=t.yearmin,t.total=t.totalmin});const t=[{data:{year:1988},y:100,dy:-50,note:{title:"Desde 1986 no se ha batido ni un solo récord de temperatura mínima",wrap:230,align:"middle"}}].map(t=>(t.subject={radius:4},t));window.makeAnnotations=d3.annotation().annotations(t).type(d3.annotationCalloutCircle).accessors({x:t=>d.count.x(t.year),y:t=>d.count.y(t.total)}).accessorsInverse({year:t=>d.count.x.invert(t.x),total:t=>d.count.y.invert(t.y)}).on("subjectover",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!1)}).on("subjectout",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!0)}),l.append("g").attr("class","annotation-test").call(makeAnnotations),l.selectAll("g.annotation-connector, g.annotation-note")}}),u(m))})};minvul();